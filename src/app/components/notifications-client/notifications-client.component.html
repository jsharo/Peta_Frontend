<!-- CLIENTE: notifications-client.component.html -->
<div class="header">
  <img src="/PETA-logo1.svg" alt="Logo" class="logo" />
  <button class="logout-btn" (click)="logout()">Cerrar SesiÃ³n</button>
</div>

<div class="notifications-main-container">
  <div class="estado-puerta">
    <p
      class="estado-puerta-text"
      [ngClass]="puertaDesbloqueada() ? 'green' : 'white'"
    >
      {{ puertaDesbloqueada() ? 'Puerta Desbloqueada' : 'Puerta Bloqueada' }}
    </p>
    <button
      class="icon-btn"
      [ngClass]="puertaDesbloqueada() ? 'icon-green' : 'icon-black'"
      (click)="togglePuerta()"
    >
      {{ puertaDesbloqueada() ? 'ðŸ”“' : 'ðŸ”’' }}
    </button>
  </div>

  <div class="notificaciones-panel">
    @if (loading()) {
      <div class="loading-spinner">Cargando notificaciones...</div>
    } @else {
      <div class="notifications-actions">
        <button (click)="markAllAsRead()">Marcar todas como leÃ­das</button>
        <div class="recargar-container">
          <button (click)="recargarNotificaciones()">Recargar</button>
        </div>
      </div>

      @if (error()) {
        <div class="error-message">
          {{ error() }}
          <button (click)="recargarNotificaciones()" class="retry-btn">Reintentar</button>
        </div>
      }

      <div class="notificaciones-chat">
        @for (n of notifications(); track n.id) {
          <div class="burbuja" [class.entrada]="n.type === 'entrada'" [class.salida]="n.type === 'salida'">
            <p class="hora">{{ n.createdAt | date: 'shortTime' }}:</p>
            <p class="mensaje">{{ n.message }}</p>
          </div>
        } @empty {
          <div class="empty-notifications">ðŸ“­ No hay notificaciones</div>
        }
      </div>
    }
  </div>
</div>

<app-navbar [activeTab]="'notificaciones'"></app-navbar>
